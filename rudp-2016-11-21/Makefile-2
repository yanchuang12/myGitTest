shell = /bin/sh

PWD_DIR=$(shell pwd)

LIB_DIR=$(PWD_DIR)/lib/
OBJECT_DIR=$(PWD_DIR)/build/
RUDP_DIR=$(PWD_DIR)/rudp/

RM=rm -fr

#****************************************************************************
#CFLAGS=-Wall -O3
CC = gcc -O 
AR = ar rc
SHARED=-shared -o
FPIC=-fpic -c

SRC_OBJECT=$(wildcard ./rudp/*.c) $(wildcard ./rudp/nd_core/*.c)

SRCS=$(notdir $(SRC_OBJECT))

H_OBJECT=$(wildcard ./rudp/*.h) $(wildcard ./rudp/nd_core/*.h)

OBJECT=$(patsubst %.c,%.o,$(SRCS))


#LIB_OBJECT = libtest.a
LIB_OBJECT_SO=libtest.so

#test:
#	echo $(SRC_OBJECT)
#	echo $(SRCS)
#	echo $(H_OBJECT)
#	echo $(OBJECT)

#****************************************************************************
.PHONY:all
all:$(LIB_OBJECT_SO) 

$(LIB_OBJECT_SO):$(OBJECT)
	#$(AR) -o $(LIB_OBJECT) $(OBJECT_DIR)*.o
	$(CC) $(SHARED) $(LIB_OBJECT_SO) $(OBJECT_DIR)*.o
	#mv $(LIB_OBJECT) $(LIB_DIR)
	mv $(LIB_OBJECT_SO) $(LIB_DIR)

$(OBJECT):$(SRC_OBJECT)
	$(CC) $(FPIC) $(SRC_OBJECT)
	mv $(OBJECT) $(OBJECT_DIR)

clean:
	$(RM) $(OBJECT_DIR)*
	$(RM) $(LIB_DIR)*





