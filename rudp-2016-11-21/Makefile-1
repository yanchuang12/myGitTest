shell = /bin/sh
PWD_DIR=$(shell pwd)
LIB_DIR=$(PWD_DIR)/lib/
OBJECT_DIR=$(PWD_DIR)/build/
RUDP_DIR=$(PWD_DIR)/rudp/


CC      := gcc -Winline 
# -Xlinker -zmuldefs
LIBS    :=
LDFLAGS :=
DEFINES :=
INCLUDE := -I.
CFLAGS  := -g $(DEFINES)
CXXFLAGS:= $(CFLAGS)
SHARE   := -fPIC -shared -o
FPIC=-fpic -c


SRC_OBJECT=$(wildcard *.c) $(wildcard ./rudp/nd_core/*.c)

SRCS=$(notdir $(SRC_OBJECT))

H_OBJECT=$(wildcard *.h) $(wildcard ./rudp/nd_core/*.h)

OBJECT=$(patsubst %.c,%.o,$(SRCS))


LIB_OBJECT = libtest.a
LIB_OBJECT_SO=libtest.so

#test:
#	echo $(SRC_OBJECT)
#	echo $(SRCS)
#	echo $(H_OBJECT)
#	echo $(OBJECT)

.PHONY:all
all:$(LIB_OBJECT_SO) 

$(LIB_OBJECT_SO):$(OBJECT)
	#$(AR) $(LIB_OBJECT) $(OBJECT_DIR)*.o
	$(CC) $(CXXFLAGS) $(SHARE) $@ $^
#$(OBJECT_DIR)*.o
	#mv $(LIB_OBJECT) $(LIB_DIR)
	#mv $(LIB_OBJECT_SO) $(LIB_DIR)

%.o:%.c
	$(CC) $(FPIC) $< -o $@
	#mv $(OBJECT) $(OBJECT_DIR)

clean:
	$(RM) *.o
#$(OBJECT_DIR)*
	$(RM) $(LIB_OBJECT_SO)
